import{a as o,_ as N,R as c,b as y,c as g,P as r,j as s,l as Z}from"./index-C-Mnn3MD.js";import{C as de}from"./CCard-COCFAoZr.js";import{C as me}from"./CRow-DzO9hZLE.js";import{C as ue}from"./CCol-B-jG07UM.js";import{u as fe,T as pe,e as _,f as he,g as be}from"./DefaultLayout-P4-M0S5b.js";import{a as ee}from"./index.esm-CGik3yLD.js";import{C as ve,a as Ce,b as O,c as k,d as ye,e as j}from"./CTable-DZk3Y4gs.js";import"./cil-user-Ddrdy7PS.js";var D=o.forwardRef(function(e,t){var n=e.children,l=e.className,i=N(e,["children","className"]);return c.createElement("div",y({className:g("modal-content",l)},i,{ref:t}),n)});D.propTypes={children:r.node,className:r.string};D.displayName="CModalContent";var re=o.createContext({}),B=o.forwardRef(function(e,t){var n,l=e.children,i=e.alignment,m=e.className,f=e.fullscreen,b=e.scrollable,x=e.size,p=N(e,["children","alignment","className","fullscreen","scrollable","size"]);return c.createElement("div",y({className:g("modal-dialog",(n={"modal-dialog-centered":i==="center"},n[typeof f=="boolean"?"modal-fullscreen":"modal-fullscreen-".concat(f,"-down")]=f,n["modal-dialog-scrollable"]=b,n["modal-".concat(x)]=x,n),m)},p,{ref:t}),l)});B.propTypes={alignment:r.oneOf(["top","center"]),children:r.node,className:r.string,fullscreen:r.oneOfType([r.bool,r.oneOf(["sm","md","lg","xl","xxl"])]),scrollable:r.bool,size:r.oneOf(["sm","lg","xl"])};B.displayName="CModalDialog";var I=o.forwardRef(function(e,t){var n=e.children,l=e.alignment,i=e.backdrop,m=i===void 0?!0:i,f=e.className,b=e.container,x=e.duration,p=x===void 0?150:x,h=e.focus,w=h===void 0?!0:h,P=e.fullscreen,T=e.keyboard,a=T===void 0?!0:T,v=e.onClose,u=e.onClosePrevented,se=e.onShow,H=e.portal,A=H===void 0?!0:H,oe=e.scrollable,ne=e.size,U=e.transition,M=U===void 0?!0:U,K=e.unmountOnClose,le=K===void 0?!0:K,R=e.visible,te=N(e,["children","alignment","backdrop","className","container","duration","focus","fullscreen","keyboard","onClose","onClosePrevented","onShow","portal","scrollable","size","transition","unmountOnClose","visible"]),$=o.useRef(null),E=o.useRef(null),ae=o.useRef(null),ce=fe(t,E),q=o.useState(R),C=q[0],S=q[1],G=o.useState(!1),J=G[0],Q=G[1],ie={visible:C,setVisible:S};o.useEffect(function(){S(R)},[R]),o.useEffect(function(){var d;return C?($.current=document.activeElement,document.addEventListener("mouseup",X),document.addEventListener("keydown",Y)):(d=$.current)===null||d===void 0||d.focus(),function(){document.removeEventListener("mouseup",X),document.removeEventListener("keydown",Y)}},[C]);var W=function(){if(m==="static")return Q(!0);S(!1)};o.useLayoutEffect(function(){u&&u(),setTimeout(function(){return Q(!1)},p)},[J]),o.useLayoutEffect(function(){return C?(document.body.classList.add("modal-open"),m&&(document.body.style.overflow="hidden",document.body.style.paddingRight="0px"),setTimeout(function(){var d;w&&((d=E.current)===null||d===void 0||d.focus())},M?p:0)):(document.body.classList.remove("modal-open"),m&&(document.body.style.removeProperty("overflow"),document.body.style.removeProperty("padding-right"))),function(){document.body.classList.remove("modal-open"),m&&(document.body.style.removeProperty("overflow"),document.body.style.removeProperty("padding-right"))}},[C]);var X=function(d){E.current&&E.current==d.target&&W()},Y=function(d){d.key==="Escape"&&a&&W()};return c.createElement(c.Fragment,null,c.createElement(pe,{in:C,mountOnEnter:!0,nodeRef:E,onEnter:se,onExit:v,unmountOnExit:le,timeout:M?p:0},function(d){return c.createElement(_,{container:b,portal:A},c.createElement(re.Provider,{value:ie},c.createElement("div",y({className:g("modal",{"modal-static":J,fade:M,show:d==="entered"},f),tabIndex:-1},C?{"aria-modal":!0,role:"dialog"}:{"aria-hidden":"true"},{style:y({},d!=="exited"&&{display:"block"})},te,{ref:ce}),c.createElement(B,{alignment:l,fullscreen:P,scrollable:oe,size:ne},c.createElement(D,{ref:ae},n)))))}),m&&c.createElement(_,{container:b,portal:A},c.createElement(he,{visible:C})))});I.propTypes={alignment:r.oneOf(["top","center"]),backdrop:r.oneOfType([r.bool,r.oneOf(["static"])]),children:r.node,className:r.string,container:r.any,duration:r.number,focus:r.bool,fullscreen:r.oneOfType([r.bool,r.oneOf(["sm","md","lg","xl","xxl"])]),keyboard:r.bool,onClose:r.func,onClosePrevented:r.func,onShow:r.func,portal:r.bool,scrollable:r.bool,size:r.oneOf(["sm","lg","xl"]),transition:r.bool,unmountOnClose:r.bool,visible:r.bool};I.displayName="CModal";var L=o.forwardRef(function(e,t){var n=e.children,l=e.className,i=N(e,["children","className"]);return c.createElement("div",y({className:g("modal-body",l)},i,{ref:t}),n)});L.propTypes={children:r.node,className:r.string};L.displayName="CModalBody";var V=o.forwardRef(function(e,t){var n=e.children,l=e.className,i=N(e,["children","className"]);return c.createElement("div",y({className:g("modal-footer",l)},i,{ref:t}),n)});V.propTypes={children:r.node,className:r.string};V.displayName="CModalFooter";var z=o.forwardRef(function(e,t){var n=e.children,l=e.className,i=e.closeButton,m=i===void 0?!0:i,f=N(e,["children","className","closeButton"]),b=o.useContext(re).setVisible;return c.createElement("div",y({className:g("modal-header",l)},f,{ref:t}),n,m&&c.createElement(be,{onClick:function(){return b(!1)}}))});z.propTypes={children:r.node,className:r.string,closeButton:r.bool};z.displayName="CModalHeader";var F=o.forwardRef(function(e,t){var n=e.children,l=e.as,i=l===void 0?"h5":l,m=e.className,f=N(e,["children","as","className"]);return c.createElement(i,y({className:g("modal-title",m)},f,{ref:t}),n)});F.propTypes={as:r.elementType,children:r.node,className:r.string};F.displayName="CModalTitle";class xe extends o.Component{render(){const{name:t,price:n,description:l}=this.props;return s.jsxs(de,{className:"subscription-card mb-4",children:[s.jsx("div",{className:"card-header",children:t||"Subscription Details"}),s.jsxs("div",{className:"card-body",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Price:"})," ",n||"N/A"]}),s.jsx("p",{className:"text-center",children:s.jsx("i",{children:l||"No description available."})})]}),s.jsx("div",{className:"card-footer text-center",children:s.jsx("button",{className:"btn btn-success w-100",onClick:this.props.onClick,children:"Purchase"})})]})}}const Me=()=>{const[e,t]=o.useState([]),[n,l]=o.useState(!0),[i,m]=o.useState(null),[f,b]=o.useState([]),[x,p]=o.useState(!1),[h,w]=o.useState(null);o.useEffect(()=>{(async()=>{const{data:v,error:u}=await Z.from("Membership").select("*").order("ValidDays",{ascending:!1});u?console.error("Error fetching memberships:",u):b(v)})()},[]),o.useEffect(()=>{(async()=>{l(!0);const{data:v,error:u}=await Z.from("Purchases").select(`
          Id,
          Price,
          CreatedDate,
          Members:BuyerId (
            Id,
            Name
          ),
          Membership:PassId (
            Id,
            Type,
            ValidDays
          ),
          AspNetUsers:CreatorId (
            Id,
            UserName
          )
        `).order("CreatedDate",{ascending:!1});u?(console.error("Failed to fetch purchases:",u),m(u)):t(v),l(!1)})()},[]);const P=a=>{w(a),p(!0)},T=()=>{console.log("Purchasing membership:",h),p(!1)};return s.jsxs(s.Fragment,{children:[s.jsx(me,{xs:{gutter:4},className:"mb-4",children:f.map(a=>s.jsx(ue,{xs:12,sm:6,md:4,lg:3,children:s.jsx(xe,{name:a.Type,price:`${a.Price} Ft`,description:a.Description,onClick:()=>P(a)})},a.Id))}),s.jsxs(I,{alignment:"center",visible:x,onClose:()=>p(!1),"aria-labelledby":"VerticallyCenteredExample",children:[s.jsx(z,{children:s.jsx(F,{id:"VerticallyCenteredExample",children:(h==null?void 0:h.Type)||"Membership Info"})}),s.jsx(L,{children:(h==null?void 0:h.Description)||"No description available."}),s.jsxs(V,{children:[s.jsx(ee,{color:"secondary",onClick:()=>p(!1),children:"Close"}),s.jsx(ee,{color:"primary",onClick:()=>T(),children:"Buy"})]})]}),s.jsxs(ve,{striped:!0,hover:!0,responsive:!0,children:[s.jsx(Ce,{children:s.jsxs(O,{children:[s.jsx(k,{children:"Name"}),s.jsx(k,{children:"Membership"}),s.jsx(k,{children:"Price"}),s.jsx(k,{children:"Date"})]})}),s.jsx(ye,{children:e.length===0?s.jsx(O,{children:s.jsx(j,{colSpan:5,className:"text-center",children:"No members found."})}):e.map(a=>{var v,u;return s.jsxs(O,{children:[s.jsx(j,{children:(v=a.Members)==null?void 0:v.Name}),s.jsx(j,{children:(u=a.Membership)==null?void 0:u.Type}),s.jsxs(j,{children:[a.Price," Ft"]}),s.jsx(j,{children:new Date(a.CreatedDate).toLocaleDateString()})]},a.Id)})})]})]})};export{Me as default};
